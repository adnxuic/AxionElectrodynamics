\section{3D Topological Insulator}

Let's consider the low-energy continuum model for prototypical 3D topological insulators such as $\mathrm{Bi}_2\mathrm{Se}_3$. The bulk electronic structure of $\mathrm{Bi}_2\mathrm{Se}_3$ near the Fermi level is described by two p-orbitals $P1_z^+$ and $P2_z^-$ with $\pm$ denoting parity. Defining the basis $\{ |P1_z^+, \uparrow \rangle, |P1_z^+, \downarrow \rangle, |P2_z^-, \uparrow \rangle, |P2_z^-, \downarrow \rangle \}$ and retaining the wave vector $\bm{k}$ up to quadratic order, the low-energy effective Hamiltonian around the $\Gamma$ point is given by:
\begin{equation}
    \begin{aligned}
    H_{\mathrm{eff}}(\bm{k}) &= 
    \begin{bmatrix} 
    M(\bm{k}) & 0 & A_1 k_z & A_2 k_- \\ 
    0 & M(\bm{k}) & A_2 k_+ & -A_1 k_z \\ 
    A_1 k_z & A_2 k_- & -M(\bm{k}) & 0 \\ 
    A_2 k_+ & -A_1 k_z & 0 & -M(\bm{k}) 
    \end{bmatrix}\\
    &= A_2 k_x \alpha_1 + A_2 k_y \alpha_2 + A_1 k_z \alpha_3 + M(\bm{k}) \alpha_4
\end{aligned}
\end{equation}
where $k_\pm = k_x \pm \mathrm{i} k_y$ and $M(\bm{k}) = m_0 - B_1 k_z^2 - B_2(k_x^2 + k_y^2)$. The $4 \times 4$ matrices $\alpha_\mu$ are given by the Dirac representation:
\begin{equation}
\alpha_j = \begin{bmatrix} 0 & \sigma_j \\ \sigma_j & 0 \end{bmatrix} , \quad \alpha_4 = \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}
\end{equation}

Next, let's consider the lattice model of above Hamiltonian, which can calculate the $\mathbb{Z}_2$ invariant identifying whether a phase is topological nontrivial or trivial.

The simplest 3D lattice is the cubic lattice. We make the changes as following (ignore lattice constant $a$).
\begin{equation}
\left\{
\begin{aligned}
k_i &\to \sin k_i \\
k_i^2 &\to 2(1 - \cos k_i)
\end{aligned}
\right.
\end{equation}

and simplify the coefficients to obtain the isotropic lattice Hamiltonian:
\begin{equation}
H_{\mathrm{eff}}(\bm{k}) = A(\alpha_1 \sin k_x + \alpha_2 \sin k_y + \alpha_3 \sin k_z) + [m_0 + r \sum (1 - \cos k_i)] \alpha_4
\end{equation}
where we define $A=A_1=A_2$ and $r=-2B_1=-2B_2$.
Then, we use Fu-Kane method to calculate the $\mathbb{Z}_2$ topological invariant for this system:
\begin{equation}
(-1)^\nu = \prod_{i=1}^{N_{\mathrm{TRIM}}} \mathrm{sgn}[M(\Lambda_i)]
\end{equation}
In this 3D cubic lattice, there are 8 TRIM (Time-Reversal Invariant Momenta which are invariant under $k_i \to -k_i$) point :
\begin{equation}
\left\{
\begin{aligned}
&\Gamma : (0,0,0) \\
&X : (\uppi,0,0)/ (0,\uppi,0)/ (0,0,\uppi) \\
&M : (\uppi,\uppi,0)/ (\uppi,0,\uppi)/ (0,\uppi,\uppi) \\
&R : (\uppi,\uppi,\uppi)
\end{aligned}
\right.
\end{equation}

\input{tikz/SymmetricPointsOfCubicLattice/SymmetricPointsOfCubicLattice.tex}

The mass term is:
\begin{equation}
M(\bm{k}) = m_0 + r \sum_{t=x,y,z} (1 - \cos k_t)
\end{equation}
so we can calculate the mass term for each group of point:
\begin{equation}
\left\{
\begin{aligned}
&\Gamma : M = m_0 \\
&X : M = m_0 + 2r \\
&M : M = m_0 + 4r \\
&R : M = m_0 + 6r
\end{aligned}
\right.
\end{equation}
Now we substitute these mass terms into the $\mathbb{Z}_2$ topological invariant formula
\begin{equation}
\begin{aligned}
(-1)^\nu &= \mathrm{sgn}(m_0) \times \mathrm{sgn}(m_0 + 2r)^3 \times \mathrm{sgn}(m_0 + 4r)^3 \times \mathrm{sgn}(m_0 + 6r) \\
&= \mathrm{sgn}(m_0) \times \mathrm{sgn}(m_0 + 2r) \times \mathrm{sgn}(m_0 + 4r) \times \mathrm{sgn}(m_0 + 6r) \\
&= \begin{cases}
-1 & (0 > \frac{m_0}{r} > -2, \ -4 > \frac{m_0}{r} > -6) \\
1 & (\frac{m_0}{r} > 0, \ -2 > \frac{m_0}{r} > -4, \ -6 > \frac{m_0}{r})
\end{cases}
\end{aligned}
\end{equation}

let's return to the continuum isotropic Hamiltonian to obtain the $\theta$ term. Consider the Hamiltonian around the $\Gamma$ point can be simplified by ignoring the terms second-order in $k_i$:
\begin{equation}
H_{\mathrm{TI}}(\bm{k}) = A \bm{k} \cdot \bm{\alpha} + m_0 \alpha_4
\end{equation}

Because this Hamiltonian describes a topological insulator, $m_0$ is less than zero 
($(-1)^\nu = \mathrm{sgn}(m_0)$). 
Except for the negative mass $m_0$, this is the usual Dirac Hamiltonian ($A\bm{k} \to c\bm{p}$).
In the presence of an external electromagnetic vector potential $\bm{A}$, minimal coupling results in:
\begin{equation}
\bm{p} \to \bm{p} + e\bm{A}
\end{equation}
where $e>0$ being the magnitude of the electron charge.
At the same time, because of the external electromagnetic scalar potential $A_0$, the energy density is modified as:
\begin{equation}
\psi^\dagger H_0 \psi \to \psi^\dagger (H_0 - eA_0) \psi
\end{equation}
So the action of the system in the presence of an external electromagnetic four potential $A_\mu = (A_0, -\bm{A})$ is written in the follow relativistic form:
\begin{equation}
\begin{aligned}
S_{\mathrm{TI}} &= \int \mathrm{d}t \mathrm{d}^3x \ \psi^\dagger \{ \mathrm{i}(\partial_t - \mathrm{i}eA_0) - [H_{\mathrm{TI}}(\bm{k} + e\bm{A})] \} \psi \\
&= \int \mathrm{d}t \mathrm{d}^3x \ \psi^\dagger [ \mathrm{i}(\partial_t - \mathrm{i}eA_0) - (-\mathrm{i}\nabla + e\bm{A}) \cdot \bm{\alpha} - m_0 \alpha_4 ] \psi
\end{aligned}
\end{equation}
where $\psi^\dagger(\bm{x},t)$ is a fermionic field representing the basis of the Hamiltonian.

Then we need to convert from the basis of $\psi^\dagger$ and $\alpha_j$ matrix to the relativistic form basis of $\bar{\psi}$ and $\gamma$ matrices:
\begin{equation}
\left\{
\begin{aligned}
&\gamma^0 = \alpha_4 = \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix} \\
&\gamma^j = \alpha_4 \alpha_j = \begin{bmatrix} 0 & \sigma_j \\ -\sigma_j & 0 \end{bmatrix} \\
&\gamma^5 = \mathrm{i} \gamma^0 \gamma^1 \gamma^2 \gamma^3 = \begin{bmatrix} 0 & I \\ I & 0 \end{bmatrix}, \\
&\bar{\psi} = \psi^\dagger \gamma^0
\end{aligned}
\right.
\end{equation}
To introduce $\bar{\psi}$, we use the identity $(\gamma^0)^2 = \mathbb{I}_{4 \times 4}$, so the Lagrangian can be rewritten as:
\begin{equation}
\begin{aligned}
\mathcal{L}_{\mathrm{TI}} &= \bar{\psi} \gamma^0 [ \mathrm{i}(\partial_t - \mathrm{i}eA_0) + \mathrm{i} \nabla \cdot \bm{\alpha} - e \bm{A} \cdot \bm{\alpha} - m_0 \alpha_4 ] \psi \\
&= \bar{\psi} [ \gamma^0 (\mathrm{i}\partial_t + \mathrm{i}\nabla \cdot \bm{\alpha}) + \gamma^0 (eA_0 - e\bm{A} \cdot \bm{\alpha}) - m_0 \gamma^0 \alpha_4 ] \psi \\
&= \bar{\psi} [ \mathrm{i} (\gamma^0 \partial_t + \bm{\gamma} \cdot \bm{\nabla}) + (eA_0 \gamma^0 - e\bm{A} \cdot \bm{\gamma}) - m_0 ] \psi \\
&= \bar{\psi} [ \mathrm{i} \gamma^\mu \partial_\mu + e \gamma^\mu A_\mu - m_0 ] \psi \\
&= \bar{\psi} [ \mathrm{i} \gamma^\mu (\partial_\mu - \mathrm{i}eA_\mu) - m_0 ] \psi
\end{aligned}
\end{equation}
In order to be convenient to study the system, we transform the system from Minkowski spacetime to Euclidean spacetime:
\begin{equation}
S_{\mathrm{TI}}^E = -\mathrm{i} S_{\mathrm{TI}}.
\end{equation}

We rewrite $t$, $A_0$ and $\gamma^j$ as following:
\begin{equation}
\left\{
\begin{aligned}
&t \to -\mathrm{i}\tau \\
&A_0 \to \mathrm{i} A_0 \\
&\gamma^j \to  \mathrm{i} \gamma_j \\
&m_0 = -m_0 (\cos \pi + \mathrm{i} \gamma_5 \sin \pi) = -m_0 e^{\mathrm{i} \pi \gamma_5}
\end{aligned}
\right.
\end{equation}
So the Euclidean spacetime action of system is written as:
\begin{equation}
S_{\mathrm{TI}}^E = \int \mathrm{d}\tau \mathrm{d}^3x \ \bar{\psi} [ \gamma_\mu (\partial_\mu - \mathrm{i}eA_\mu) - m_0 e^{\mathrm{i} \pi \gamma_5} ] \psi
\end{equation}
Now we apply Fujikawa's method to the action. First, let's consider an infinitesimal chiral transformation defined by:
\begin{equation}
\left\{
\begin{aligned}
&\psi \to \psi' = e^{-\frac{\mathrm{i} \pi \phi}{2} \gamma_5} \psi \\
&\bar{\psi} \to \bar{\psi}' = \bar{\psi} e^{-\frac{\mathrm{i} \pi \phi}{2} \gamma_5}
\end{aligned}
\right.
\end{equation}
where $\phi \in [0,1]$. Then the partition function $Z$ is transformed as:
\begin{equation}
\begin{aligned}
&Z = \int D[\psi, \bar{\psi}] e^{-S_{\mathrm{TI}}^E[\psi, \bar{\psi}]} \\
\Rightarrow & Z' = \int D[\psi', \bar{\psi}'] e^{-S_{\mathrm{TI}}^E[\psi', \bar{\psi}']}
\end{aligned}
\end{equation}

let's see the first term of $S_{TI}^{E'}$ :
\begin{equation}
K = \int \mathrm{d}\tau \mathrm{d}^3x \ \bar{\psi} e^{-\mathrm{i}\theta \gamma_5} [\gamma_\mu(\partial_\mu - \mathrm{i}eA_\mu)] e^{-\mathrm{i}\theta \gamma_5} \psi
\end{equation}
where $\theta = \frac{\pi \mathrm{d}\phi}{2}$. Because the anticommutation relation $\{\gamma_\mu, \gamma_\nu\} = 2\delta_{\mu\nu}$ is satisfied, so:
\begin{equation}
e^{-\mathrm{i}\theta \gamma_5} \gamma_\mu = \gamma_\mu e^{\mathrm{i}\theta \gamma_5}
\end{equation}
The Lagrangian of K can be written as:
\begin{equation}
\begin{aligned}
\mathcal{L}_K &= \bar{\psi} \gamma_\mu e^{\mathrm{i}\theta \gamma_5} (\partial_\mu - \mathrm{i}eA_\mu) e^{-\mathrm{i}\theta \gamma_5} \psi \\
&= \bar{\psi} \gamma_\mu (\partial_\mu - \mathrm{i}eA_\mu) \psi
\end{aligned}
\end{equation}

Next, let's see the mass term of $S_{TI}^{E'}$ :
\begin{equation}
\begin{aligned}
\mathcal{L}_M &= -\bar{\psi} e^{-\mathrm{i}\theta \gamma_5} m_0 e^{\mathrm{i}\pi \gamma_5} e^{-\mathrm{i}\theta \gamma_5} \psi \\
&= -m_0 \bar{\psi} e^{\mathrm{i}\pi(1 - \mathrm{d}\phi)\gamma_5} \psi
\end{aligned}
\end{equation}
So the action in Euclidean space time is transformed as:
\begin{equation}
S_{TI}^{'E} = \int \mathrm{d}\tau \mathrm{d}^3x \ \bar{\psi} [\gamma_\mu(\partial_\mu - \mathrm{i}eA_\mu) - m_0 e^{\mathrm{i}\pi(1-\mathrm{d}\phi)\gamma_5}] \psi
\end{equation}

We should consider the transformation of $D[\psi', \bar{\psi}']$
\begin{equation}
D[\psi', \bar{\psi}'] = J D[\psi, \bar{\psi}]
\end{equation}
The Jacobian J is written as:
\begin{equation}
\ln J = -\mathrm{i} \int \mathrm{d}\tau \mathrm{d}^3x \ \mathrm{d}\phi \frac{\pi e^2}{16 \pi^2} {}^\star F^{\mu\nu} F_{\mu\nu}
\end{equation}
We integrate with respect to the variable $\phi$ from 0 to 1. Due to the invariance of the partition function, finally, we arrive at the following expression of $S_{TI}^E$:
\begin{equation}
S_{TI}^E = \int \mathrm{d}\tau \mathrm{d}^3x \bar{\psi} [\gamma_\mu (\partial_\mu - \mathrm{i}eA_\mu) - m_0] \psi + \mathrm{i} \int \mathrm{d}\tau \mathrm{d}^3x \frac{\pi e^2}{16 \pi^2} {}^\star F^{\mu\nu} F_{\mu\nu}
\end{equation}
The first term is the action of a topological trivial insulator since the mass $-m_0$ is positive. The second term is the $\theta$ term whose $\theta$ equal to $\pi$ in the imaginary time.
Thus, we have demonstrated that for 3D topological insulators, the $\theta$ in $\theta$ term is $\pi$.